<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Visualizing Two Numeric Variables in R — Hands-On Guide</title>
  <link href="https://fonts.googleapis.com/css2?family=STIX+Two+Text:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#ffffff; --panel:#ffffff; --ink:#0f172a; --muted:#475569; --brand:#1d4ed8; --accent:#059669;
      --chip:#f1f5f9; --border:#e2e8f0; --code:#f8fafc;
    }
    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{margin:0;background:var(--bg);color:var(--ink);font:16px/1.6 "STIX Two Text","Times New Roman",Times,serif}
    h1{font-size:28px;margin:0 0 8px}
    h2{font-size:24px;margin:22px 0 8px}
    .lead{font-size:18px}
    .wrap{max-width:1000px;margin:0 auto;padding:24px}
    .panel{background:var(--panel);border:1px solid var(--border);border-radius:16px;padding:16px;margin-bottom:20px}
    .viz{background:var(--chip);border:1px solid var(--border);border-radius:14px;padding:10px}
    .chip{display:inline-block;background:var(--chip);border:1px solid var(--border);padding:2px 8px;border-radius:999px;font-size:12px}
    pre{background:var(--code);border:1px solid var(--border);border-radius:10px;padding:12px;overflow:auto}
    .controls{display:flex;gap:12px;flex-wrap:wrap;align-items:center}
    .footer{margin:28px 0 8px;color:var(--muted);font-size:14px}
  </style>
</head>
<body>
  <header class="panel" style="position:sticky;top:0;z-index:10;backdrop-filter:saturate(1.2) blur(6px)">
    <div class="wrap" style="padding:8px 24px">
      <h1>Visualizing Two Numeric Variables in R</h1>
      <div class="controls">
        <span class="chip">Live demo data</span>
        <label>n = <input id="n" type="range" min="50" max="2000" value="500" step="50"> <strong id="nval">500</strong></label>
        <button id="regen" class="chip">Regenerate</button>
      </div>
    </div>
  </header>

  <main class="wrap">
    <section class="panel">
      <p class="lead">When we have <strong>two numeric variables</strong> (say <code>x</code> and <code>y</code>), the key task is to visualize their <em>relationship</em>: trends, clusters, correlation, outliers. The most fundamental tool is the <strong>scatter plot</strong>, but there are useful variants when the dataset is large or noisy.</p>
    </section>

    <section id="scatter" class="panel">
      <h2>1) Scatter plot</h2>
      <div id="viz-scatter" class="viz" role="img" aria-label="Scatter plot"></div>
      <details><summary>R / ggplot2</summary>
<pre><code class="language-r">library(tidyverse)
df <- tibble(x = rnorm(500), y = 1.5*x + rnorm(500, sd=0.8))
ggplot(df, aes(x, y)) +
  geom_point(alpha = 0.6, color = "#2563eb") +
  labs(title = "Scatter plot", x = "x", y = "y") +
  theme_minimal()</code></pre>
      </details>
    </section>

    <section id="smooth" class="panel">
      <h2>2) Adding a smoother</h2>
      <p>Scatter plots can be enhanced with regression or smooth trend lines (linear, LOESS, GAM). These highlight patterns that may be hidden in noise.</p>
      <div id="viz-smooth" class="viz" role="img" aria-label="Scatter with smoother"></div>
      <details><summary>R / ggplot2</summary>
<pre><code class="language-r">ggplot(df, aes(x, y)) +
  geom_point(alpha = 0.5, color = "#2563eb") +
  geom_smooth(method = "lm", se = TRUE, color = "#dc2626") +
  labs(title = "Scatter with linear regression line") +
  theme_minimal()</code></pre>
      </details>
    </section>

    <section id="hexbin" class="panel">
      <h2>3) Dealing with many points: hexbin / 2D density</h2>
      <p>When there are thousands of points, scatter plots suffer from overplotting. Alternatives: <strong>hexbin plots</strong> (bin into hexagons) or <strong>2D density contours</strong>.</p>
      <div id="viz-hex" class="viz" role="img" aria-label="Hexbin plot"></div>
      <details><summary>R / ggplot2</summary>
<pre><code class="language-r"># Hexbin
ggplot(df, aes(x, y)) +
  geom_hex() +
  coord_equal() +
  theme_minimal()

# 2D density contours
ggplot(df, aes(x, y)) +
  geom_point(alpha = 0.2) +
  geom_density_2d(color = "red") +
  theme_minimal()</code></pre>
      </details>
    </section>

    <section id="cor" class="panel">
      <h2>4) Correlation coefficient</h2>
      <p>A numeric summary: Pearson's <code>r</code> measures linear association (−1 to +1). Always pair correlation with a plot, since <em>nonlinear</em> relationships can fool correlation.</p>
<pre><code class="language-r">cor(df$x, df$y)   # Pearson correlation
cor(df$x, df$y, method = "spearman") # Spearman (rank-based)</code></pre>
    </section>

    <section class="panel">
      <h2>Pitfalls & tips</h2>
      <ul>
        <li><strong>Overplotting:</strong> Use alpha blending or hexbin/density plots.</li>
        <li><strong>Outliers:</strong> Can strongly affect regression and correlation.</li>
        <li><strong>Nonlinear patterns:</strong> Check LOESS/GAM smoothers.</li>
        <li><strong>Units & scales:</strong> If variables have very different scales, consider standardization.</li>
      </ul>
    </section>

    <div class="footer">Made with ❤️ for R users. Copy, tweak, and ship.</div>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
  <script>
    const W=680,H=300,M={t:20,r:20,b:35,l:40};
    const innerW=W-M.l-M.r, innerH=H-M.t-M.b;
    const $=sel=>document.querySelector(sel);

    function sampleData(n){
      const x = d3.range(n).map(()=> d3.randomNormal(0,1)());
      const y = x.map(v=> 1.5*v + d3.randomNormal(0,0.8)());
      return x.map((v,i)=>({x:v,y:y[i]}));
    }
    function frame(sel,xlab,ylab){
      const svg=d3.select(sel).html("")
        .append("svg").attr("viewBox",`0 0 ${W} ${H}`);
      const g=svg.append("g").attr("transform",`translate(${M.l},${M.t})`);
      g.append("g").attr("class","x-axis").attr("transform",`translate(0,${innerH})`);
      g.append("g").attr("class","y-axis");
      return {g,svg};
    }
    function renderAll(){
      const n=+$('#n').value; $('#nval').textContent=n;
      const data=sampleData(n);
      const xdom=d3.extent(data,d=>d.x), ydom=d3.extent(data,d=>d.y);
      const xScale=d3.scaleLinear().domain(xdom).nice().range([0,innerW]);
      const yScale=d3.scaleLinear().domain(ydom).nice().range([innerH,0]);

      // Scatter
      (function(){
        const {g}=frame('#viz-scatter');
        g.select('.x-axis').call(d3.axisBottom(xScale));
        g.select('.y-axis').call(d3.axisLeft(yScale));
        g.selectAll('circle').data(data).enter().append('circle')
          .attr('cx',d=>xScale(d.x)).attr('cy',d=>yScale(d.y))
          .attr('r',3).attr('fill','#2563eb').attr('opacity',0.6);
      })();

      // Scatter with regression line
      (function(){
        const {g}=frame('#viz-smooth');
        g.select('.x-axis').call(d3.axisBottom(xScale));
        g.select('.y-axis').call(d3.axisLeft(yScale));
        g.selectAll('circle').data(data).enter().append('circle')
          .attr('cx',d=>xScale(d.x)).attr('cy',d=>yScale(d.y))
          .attr('r',2.5).attr('fill','#2563eb').attr('opacity',0.5);
        // Simple linear regression
        const xmean=d3.mean(data,d=>d.x), ymean=d3.mean(data,d=>d.y);
        const slope=d3.sum(data,d=>(d.x-xmean)*(d.y-ymean))/d3.sum(data,d=>(d.x-xmean)**2);
        const intercept=ymean-slope*xmean;
        const linePts=[xdom[0],xdom[1]].map(x=>({x,y:slope*x+intercept}));
        g.append('line').attr('x1',xScale(linePts[0].x)).attr('y1',yScale(linePts[0].y))
          .attr('x2',xScale(linePts[1].x)).attr('y2',yScale(linePts[1].y))
          .attr('stroke','#dc2626').attr('stroke-width',2);
      })();

      // Hexbin (approximate using bin2d)
      (function(){
        const {g}=frame('#viz-hex');
        const hexbin=d3.hexbin().x(d=>xScale(d.x)).y(d=>yScale(d.y)).radius(12).extent([[0,0],[innerW,innerH]]);
        const bins=hexbin(data);
        const c=d3.scaleSequential(d3.interpolateBlues).domain([0,d3.max(bins,d=>d.length)]);
        g.append("g").selectAll("path").data(bins).enter().append("path")
          .attr("d",hexbin.hexagon())
          .attr("transform",d=>`translate(${d.x},${d.y})`)
          .attr("fill",d=>c(d.length))
          .attr("stroke","white");
        g.select('.x-axis').call(d3.axisBottom(xScale));
        g.select('.y-axis').call(d3.axisLeft(yScale));
      })();
    }
    document.getElementById('n').addEventListener('input',renderAll);
    document.getElementById('regen').addEventListener('click',renderAll);
    renderAll();
  </script>
</body>
</html>
